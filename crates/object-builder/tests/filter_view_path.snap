[objects]
{

    "a0000000-0000-0000-0000-000000000001,00000000-0000-0000-0000-000000000001": { "a": 2 },
    "a0000000-0000-0000-0000-000000000002,00000000-0000-0000-0000-000000000002": { "b": 42 },
    "a0000000-0000-0000-0000-000000000002,00000000-0000-0000-0000-000000000003": { "b": 2 }
}


[tree_response]
{
  "rows":[
    {
      "base_object_id": "00000000-0000-0000-0000-000000000001",
      "relation_object_ids":[
        "00000000-0000-0000-0000-000000000002"
      ]
    },
    {
      "base_object_id": "00000000-0000-0000-0000-000000000001",
      "relation_object_ids":[
        "00000000-0000-0000-0000-000000000003"
      ]
    }
  ]
}

[relation_map]
{
  "b0000000-0000-0000-0000-000000000001":
    ["a0000000-0000-0000-0000-000000000001","a0000000-0000-0000-0000-000000000002"]
}

[view]
{
  "id": "00000000-0000-0000-0000-000000000001",
  "name": "Sample View",
  "base_schema_id": "a0000000-0000-0000-0000-000000000001",
  "materializer_options": {},
  "materializer_address": "",
  "fields": {
    "foo": {
      "simple": {
        "field_name": "a",
        "field_type": "numeric"
      }
    },
    "bar": {
      "computed": {
        "field_type": "numeric",
        "computation": {
          "raw_value": 42
        }
      }
    }
  },
  "filters": {
    "simple_filter": {
      "filter": {
        "equals": {
          "lhs": {
            "view_path": {
              "field_path": "bar"
            }
          },
          "rhs": {
            "schema_field": {
              "schema_id": 1,
              "field_path": "b"
            }
          }
        }
      }
    }
  },
  "relations": [
    {
      "global_id": "b0000000-0000-0000-0000-000000000001",
      "local_id": 1,
      "search_for": "CHILDREN"
    }
 ]
}

[expected.view_plan_build]
{
  "missing": {
    "a0000000-0000-0000-0000-000000000001,00000000-0000-0000-0000-000000000001": [
      0,
      1
    ],
    "a0000000-0000-0000-0000-000000000002,00000000-0000-0000-0000-000000000002": [
      0
    ],
    "a0000000-0000-0000-0000-000000000002,00000000-0000-0000-0000-000000000003": [
      1
    ]
  },
  "unfinished_rows": [
    {
      "fields": {
        "bar": {
          "computed": {
            "computation": {
              "raw_value": {
                "value": 42
              }
            },
            "field_type": "Numeric"
          }
        },
        "foo": {
          "simple": {
            "field_name": "a",
            "field_type": "Numeric",
            "object": "a0000000-0000-0000-0000-000000000001,00000000-0000-0000-0000-000000000001"
          }
        }
      },
      "filters": {
        "equals": {
          "lhs": {
            "view_path": {
              "field_path": "bar"
            }
          },
          "rhs": {
            "schema_field": {
              "field_path": "b",
              "object": "a0000000-0000-0000-0000-000000000002,00000000-0000-0000-0000-000000000002"
            }
          }
        }
      },
      "missing": 2,
      "objects": {},
      "relation_order": [
        "a0000000-0000-0000-0000-000000000001,00000000-0000-0000-0000-000000000001",
        "a0000000-0000-0000-0000-000000000002,00000000-0000-0000-0000-000000000002"
      ],
      "root_object": "a0000000-0000-0000-0000-000000000001,00000000-0000-0000-0000-000000000001"
    },
    {
      "fields": {
        "bar": {
          "computed": {
            "computation": {
              "raw_value": {
                "value": 42
              }
            },
            "field_type": "Numeric"
          }
        },
        "foo": {
          "simple": {
            "field_name": "a",
            "field_type": "Numeric",
            "object": "a0000000-0000-0000-0000-000000000001,00000000-0000-0000-0000-000000000001"
          }
        }
      },
      "filters": {
        "equals": {
          "lhs": {
            "view_path": {
              "field_path": "bar"
            }
          },
          "rhs": {
            "schema_field": {
              "field_path": "b",
              "object": "a0000000-0000-0000-0000-000000000002,00000000-0000-0000-0000-000000000003"
            }
          }
        }
      },
      "missing": 2,
      "objects": {},
      "relation_order": [
        "a0000000-0000-0000-0000-000000000001,00000000-0000-0000-0000-000000000001",
        "a0000000-0000-0000-0000-000000000002,00000000-0000-0000-0000-000000000003"
      ],
      "root_object": "a0000000-0000-0000-0000-000000000001,00000000-0000-0000-0000-000000000001"
    }
  ]
}

[expected.built_rows]
[
  {
    "fields": {
      "bar": 42,
      "foo": 2
    },
    "objects": [
      "a0000000-0000-0000-0000-000000000001,00000000-0000-0000-0000-000000000001",
      "a0000000-0000-0000-0000-000000000002,00000000-0000-0000-0000-000000000002"
    ]
  }
]

[end]
