<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>0019 - Simplify Schema Definitions - The Common Data Layer</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="../favicon.svg">
        
        
        <link rel="shortcut icon" href="../favicon.png">
        
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        
        <link rel="stylesheet" href="../css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="../fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../index.html"><strong aria-hidden="true">1.</strong> Common Data Layer</a></li><li class="chapter-item expanded "><a href="../how_it_works.html"><strong aria-hidden="true">2.</strong> How does it work</a></li><li class="chapter-item expanded "><a href="../getting_started.html"><strong aria-hidden="true">3.</strong> Getting Started</a></li><li class="chapter-item expanded "><a href="../deployment/index.html"><strong aria-hidden="true">4.</strong> Deployment</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../deployment/local/index.html"><strong aria-hidden="true">4.1.</strong> Local deployment</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../deployment/local/docker-compose.html"><strong aria-hidden="true">4.1.1.</strong> docker-compose</a></li><li class="chapter-item expanded "><a href="../deployment/local/helm.html"><strong aria-hidden="true">4.1.2.</strong> Helm</a></li></ol></li><li class="chapter-item expanded "><a href="../deployment/production/index.html"><strong aria-hidden="true">4.2.</strong> Production-grade deployment</a></li></ol></li><li class="chapter-item expanded "><a href="../schemas_and_views.html"><strong aria-hidden="true">5.</strong> Schemas and Views</a></li><li class="chapter-item expanded "><a href="../examples/index.html"><strong aria-hidden="true">6.</strong> Examples</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../examples/materialization.html"><strong aria-hidden="true">6.1.</strong> Materialization</a></li></ol></li><li class="chapter-item expanded "><a href="../features/index.html"><strong aria-hidden="true">7.</strong> Features</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../features/ordering.html"><strong aria-hidden="true">7.1.</strong> Message ordering</a></li><li class="chapter-item expanded "><a href="../features/client_routing.html"><strong aria-hidden="true">7.2.</strong> Client routing</a></li></ol></li><li class="chapter-item expanded "><a href="../processes/index.html"><strong aria-hidden="true">8.</strong> Processes</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../processes/0001_Commit_message_formalization_and_enforcement.html"><strong aria-hidden="true">8.1.</strong> Commit message formalization and enforcement</a></li><li class="chapter-item expanded "><a href="../processes/0002_Branching_strategy.html"><strong aria-hidden="true">8.2.</strong> Branhing strategy</a></li><li class="chapter-item expanded "><a href="../processes/0003_Documentation_structure_and_RFC_process.html"><strong aria-hidden="true">8.3.</strong> Documentation structure and RFC process</a></li><li class="chapter-item expanded "><a href="../processes/0004_Internal_performance_testing.html"><strong aria-hidden="true">8.4.</strong> CDL Performance Testing</a></li></ol></li><li class="chapter-item expanded "><a href="../versioning.html"><strong aria-hidden="true">9.</strong> Versioning</a></li><li class="chapter-item expanded "><a href="../stability.html"><strong aria-hidden="true">10.</strong> Stability</a></li><li class="chapter-item expanded "><a href="../protocol.html"><strong aria-hidden="true">11.</strong> Protocol schema</a></li><li class="chapter-item expanded "><a href="../benchmarks.html"><strong aria-hidden="true">12.</strong> Benchmarks</a></li><li class="chapter-item expanded "><a href="../architecture/index.html"><strong aria-hidden="true">13.</strong> Architecture</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../architecture/management.html"><strong aria-hidden="true">13.1.</strong> Management Layer</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../architecture/cli.html"><strong aria-hidden="true">13.1.1.</strong> CLI</a></li><li class="chapter-item expanded "><a href="../architecture/web_admin.html"><strong aria-hidden="true">13.1.2.</strong> Admin Web Panel</a></li></ol></li><li class="chapter-item expanded "><a href="../architecture/api.html"><strong aria-hidden="true">13.2.</strong> GraphQL API</a></li><li class="chapter-item expanded "><a href="../architecture/configuration.html"><strong aria-hidden="true">13.3.</strong> Configuration Layer</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../architecture/schema_registry.html"><strong aria-hidden="true">13.3.1.</strong> Schema Registry</a></li><li class="chapter-item expanded "><a href="../architecture/leader_elector.html"><strong aria-hidden="true">13.3.2.</strong> Leader Elector</a></li><li class="chapter-item expanded "><a href="../architecture/edge_registry.html"><strong aria-hidden="true">13.3.3.</strong> Edge Registry</a></li></ol></li><li class="chapter-item expanded "><a href="../architecture/ingestion.html"><strong aria-hidden="true">13.4.</strong> Ingestion Layer</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../architecture/data_router.html"><strong aria-hidden="true">13.4.1.</strong> Data Router</a></li></ol></li><li class="chapter-item expanded "><a href="../architecture/storage.html"><strong aria-hidden="true">13.5.</strong> Storage Layer</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../architecture/command_service.html"><strong aria-hidden="true">13.5.1.</strong> Command Service</a></li><li class="chapter-item expanded "><a href="../architecture/db_shrinker_storage.html"><strong aria-hidden="true">13.5.2.</strong> Db Shrinker Storage</a></li><li class="chapter-item expanded "><a href="../architecture/query_service.html"><strong aria-hidden="true">13.5.3.</strong> Query Service</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">13.6.</strong> Materialization Layer</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../architecture/object_builder.html"><strong aria-hidden="true">13.6.1.</strong> Object Builder</a></li><li class="chapter-item expanded "><a href="../architecture/partial_update_engine.html"><strong aria-hidden="true">13.6.2.</strong> Partial Update Engine</a></li><li class="chapter-item expanded "><a href="../architecture/materializer_general.html"><strong aria-hidden="true">13.6.3.</strong> General Materializer</a></li><li class="chapter-item expanded "><a href="../architecture/materializer_ondemand.html"><strong aria-hidden="true">13.6.4.</strong> On Demand Materializer</a></li></ol></li><li class="chapter-item expanded "><a href="../architecture/retrieval.html"><strong aria-hidden="true">13.7.</strong> Retrieval Layer</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../architecture/query_router.html"><strong aria-hidden="true">13.7.1.</strong> Query Router</a></li></ol></li><li class="chapter-item expanded "><a href="../architecture/utils.html"><strong aria-hidden="true">13.8.</strong> Utils</a></li></ol></li><li class="chapter-item expanded "><a href="../configuration/index.html"><strong aria-hidden="true">14.</strong> Configuration</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../configuration/generator.html"><strong aria-hidden="true">14.1.</strong> (tool) generator</a></li><li class="chapter-item expanded "><a href="../configuration/api.html"><strong aria-hidden="true">14.2.</strong> api</a></li><li class="chapter-item expanded "><a href="../configuration/command-service.html"><strong aria-hidden="true">14.3.</strong> command-service</a></li><li class="chapter-item expanded "><a href="../configuration/data-router.html"><strong aria-hidden="true">14.4.</strong> data-router</a></li><li class="chapter-item expanded "><a href="../configuration/edge-registry.html"><strong aria-hidden="true">14.5.</strong> edge-registry</a></li><li class="chapter-item expanded "><a href="../configuration/materializer-general.html"><strong aria-hidden="true">14.6.</strong> materializer-general</a></li><li class="chapter-item expanded "><a href="../configuration/materializer-ondemand.html"><strong aria-hidden="true">14.7.</strong> materializer-ondemand</a></li><li class="chapter-item expanded "><a href="../configuration/object-builder.html"><strong aria-hidden="true">14.8.</strong> object-builder</a></li><li class="chapter-item expanded "><a href="../configuration/partial-update-engine.html"><strong aria-hidden="true">14.9.</strong> partial-update-engine</a></li><li class="chapter-item expanded "><a href="../configuration/query-router.html"><strong aria-hidden="true">14.10.</strong> query-router</a></li><li class="chapter-item expanded "><a href="../configuration/query-service.html"><strong aria-hidden="true">14.11.</strong> query-service</a></li><li class="chapter-item expanded "><a href="../configuration/query-service-ts.html"><strong aria-hidden="true">14.12.</strong> query-service-ts</a></li><li class="chapter-item expanded "><a href="../configuration/schema-registry.html"><strong aria-hidden="true">14.13.</strong> schema-registry</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">15.</strong> RFCs</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../rfc/0022_Materialization_Types_01.html"><strong aria-hidden="true">15.1.</strong> 0022 - Materialization Types</a></li><li class="chapter-item expanded "><a href="../rfc/0021_Custom_Data_Passthrough_01.html"><strong aria-hidden="true">15.2.</strong> 0021 - Custom Data Passthrough</a></li><li class="chapter-item expanded "><a href="../rfc/0020_Configuration_Service_01.html"><strong aria-hidden="true">15.3.</strong> 0020 - Configuration service</a></li><li class="chapter-item expanded "><a href="../rfc/0019_Simplify_Schema_Definitions_01.html" class="active"><strong aria-hidden="true">15.4.</strong> 0019 - Simplify Schema Definitions</a></li><li class="chapter-item expanded "><a href="../rfc/0018_Transport_headers_passthrough_01.html"><strong aria-hidden="true">15.5.</strong> 0018 - Transport headers passthrough</a></li><li class="chapter-item expanded "><a href="../rfc/0017_Edge_registry_resolving_relation_trees_01.html"><strong aria-hidden="true">15.6.</strong> 0017 - Edge Registry: Resolving relation trees</a></li><li class="chapter-item expanded "><a href="../rfc/0015_CI_CD_RnD_01.html"><strong aria-hidden="true">15.7.</strong> 0015 - CI/CD setup R&amp;D</a></li><li class="chapter-item expanded "><a href="../rfc/0014_Query_raw_routes_01.html"><strong aria-hidden="true">15.8.</strong> 0014 - Query raw routes</a></li><li class="chapter-item expanded "><a href="../rfc/0013_Documentation_restructure_and_RFC_process_01.html"><strong aria-hidden="true">15.9.</strong> 0013 - Documentation restructure and RFC process</a></li><li class="chapter-item expanded "><a href="../rfc/0012_CDL_documentation_generation_01.html"><strong aria-hidden="true">15.10.</strong> 0012 - CDL Documentation Generation</a></li><li class="chapter-item expanded "><a href="../rfc/0011_Branching_strategy_01.html"><strong aria-hidden="true">15.11.</strong> 0011 - Branching strategy</a></li><li class="chapter-item expanded "><a href="../rfc/0010_Schema_Registry_less_CDL_deployment_01.html"><strong aria-hidden="true">15.12.</strong> 0010 - Schema-Registry-less CDL deployment</a></li><li class="chapter-item expanded "><a href="../rfc/0009_CDL_Ingestion_API_versioning_02.html"><strong aria-hidden="true">15.13.</strong> 0009 - CdlIM Versioning 2.0</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../rfc/archive/0005_CDL_Ingestion_API_versioning_01.html"><strong aria-hidden="true">15.13.1.</strong> 0005 - CdlIM Versioning</a></li></ol></li><li class="chapter-item expanded "><a href="../rfc/0008_CDL_publishing_deployment_configurations_01.html"><strong aria-hidden="true">15.14.</strong> 0008 - CDL publishing deployment configurations</a></li><li class="chapter-item expanded "><a href="../rfc/0007_Materialized_views_01.html"><strong aria-hidden="true">15.15.</strong> 0007 - Materialized Views</a></li><li class="chapter-item expanded "><a href="../rfc/0006_Edge_registry_01.html"><strong aria-hidden="true">15.16.</strong> 0006 - Edge Registry</a></li><li class="chapter-item expanded "><a href="../rfc/0004_Commit_message_formalization_and_enforcement_01.html"><strong aria-hidden="true">15.17.</strong> 0004 - Commit message formalization</a></li><li class="chapter-item expanded "><a href="../rfc/0003_Usage_of_Message_Pack_format_as_a_CDL_input_01.html"><strong aria-hidden="true">15.18.</strong> 0003 - MessagePack support</a></li><li class="chapter-item expanded "><a href="../rfc/0002_Materialization_01.html"><strong aria-hidden="true">15.19.</strong> 0002 - Materialization - Overview</a></li><li class="chapter-item expanded "><a href="../rfc/0001_Alternative_communication_method_01.html"><strong aria-hidden="true">15.20.</strong> 0001 - Alternative communication method</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">The Common Data Layer</h1>

                    <div class="right-buttons">
                        
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                        <a href="https://github.com/epiphany-platform/CommonDataLayer" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#front-matter" id="front-matter">Front Matter</a></h1>
<pre><code>    Title           : Simplify Schema Definitions
    Author(s)       : Samuel Mohr
    Team            : CommonDataLayer
    Reviewer        : CommonDataLayer
    Created         : 2021-07-06
    Last updated    : 2021-07-06
    Category        : Feature
    CDL Feature ID  : CDLF-00020-00
</code></pre>
<h2><a class="header" href="#glossary" id="glossary">Glossary</a></h2>
<h3><a class="header" href="#terminology" id="terminology">Terminology</a></h3>
<ul>
<li>CDL - Common Data Layer</li>
<li>SR - Schema Registry, a CDL component responsible for keeping information about the type of object conveyed inside the message.</li>
<li>User - user of the CDL.</li>
<li>Schema Definition - a schematic representing the expected format for data belonging to a given Schema.</li>
</ul>
<h2><a class="header" href="#formats" id="formats">Formats</a></h2>
<p>Schema:</p>
<pre><code>{
    id: UUID,
    name: String,
    definition: Map&lt;String, ObjectFieldDefinition&gt;, // definitions can only be non-null objects
    ... // other configuration metadata
}
</code></pre>
<p>ScalarType:</p>
<pre><code>Bool | String | Integer | Decimal | Any // Any represents arbitrary JSON data
</code></pre>
<p>ObjectFieldDefinition:</p>
<pre><code>{
   type: ScalarType,
   optional: Bool,
}
</code></pre>
<p>SchemaDefinition:</p>
<pre><code>Scalar {
    type: ScalarType,
    optional: Bool,
} |
Object {
    fields: Map&lt;String, ObjectFieldDefinition&gt;,
} |
Array {
    item_type: ChildType,
    optional: Bool,
}
</code></pre>
<h2><a class="header" href="#introduction" id="introduction">Introduction</a></h2>
<h3><a class="header" href="#background" id="background">Background</a></h3>
<p>Schemas, as defined in the SR, are a means to represent discrete types of data to be stored in the CDL.
Beyond metadata such as the name of the schema and addresses for repository storage and retrieval, they
also store definitions describing the format of their respective data types. Though the data is not currently
being validated based on its type, the type definition is useful for understanding the data format. In addition,
since materialization stores values based on views, which use types from schemas, we can use the field types
of schema definitions to determine what types a view comprises. This lets us more efficiently store materialized
data.</p>
<p>Currently, though not used, each schema has a definition, defined using a JSON Schema. <a href="https://json-schema.org/">JSON Schema</a>
is a protocol for constraining data stored as JSON. On top of tradition typing of fields, it also can perform
complex checks, such as logical operations with respect to field existence and numerical constraints on values.
It can also define relationships to other schemas, which is a behavioral requirement for the CDL's schemas. These
checks are generally valuable, and led to us choosing it as a means for defining schema data types some months
ago. However, the inherent complexity of JSON Schema prevents us from being able to simply determine what type a
field is in a definition. So long as we maintain JSON Schema as the solution for user-defined data definitions,
it will remain infeasible to determine types of individual fields in views for more efficient materialization
(spatially and temporally).</p>
<h3><a class="header" href="#assumptions" id="assumptions">Assumptions</a></h3>
<p>There is not currently a need to provide mutative access to schema definitions, so the re-implementation of schema
definitions does not need to work with that in mind, though a solution robust to that potential future requirement
may be preferable.</p>
<h2><a class="header" href="#proposed-solution" id="proposed-solution">Proposed Solution</a></h2>
<p>There does not exist, in the space of the Rust ecosystem, an existing solution for us to use. Therefore, this
RFC proposes a novel-yet-simple system for defining schema definitions allowing for definition composition and
representation of all valid JSON data. The proposed new form of schema definitions will be referred to as
Schema Definitions, or SD's for the rest of this document.</p>
<p>Currently, JSON schemas are stored as metadata of schemas in a one-to-one relationship, disallowing the reuse
of schema definitions between schemas. In the new solution, this will change where each definition is stored
with a unique ID (a UUID will suffice) and the provided definition. Each schema will be required to hold a
definition ID. This will allow for easier relationship definition between SD's, and potentially allowing for
&quot;mutation&quot; of SD's without actually removing the old definition from the SR. These aspects will be explained
further on in this proposal.</p>
<p>In an effort to maintain a similar structure to JSON data and not added unnecessary complexity, SD's will be
represented as sum types. Beyond a variant for each of the scalars available in JSON (<code>Boolean</code>, <code>String</code>,
<code>Integer</code>, and <code>Decimal</code>), the other two types of JSON data are <code>Array</code>s and <code>Object</code>s. <code>Array</code>s will refer
to a single child definition, whether that be a scalar type or a different schema's definition. <code>Object</code>s will
refer to a list of string-named fields, where the definition of each field is either a scalar or another Schema's
definition. <code>Array</code> or <code>Object</code> child definitions can all be optional, which allows items to either be <code>Null</code>
or missing, in the case of fields in <code>Object</code>s.</p>
<p>In the case that some JSON data is too complicated to be represented by the proposed system, or a user would like
to opt out of the optimizations provided by properly-typed schemas, the <code>Any</code> scalar variant will accept any valid
JSON data.</p>
<h3><a class="header" href="#use-in-materialization" id="use-in-materialization">Use in Materialization</a></h3>
<p>With this system, all fields in a schema definition have deterministic types. Given that, any view that references
fields from an <code>Object</code> schema definition can know the field's type. Either the type is a potentially nullable scalar,
which can be represented by a SQL type, or it is a more complicated type (or an <code>Any</code> scalar), and it falls back to
a JSON type. That way, all materialized data can have its fields stored in its respective types.</p>
<h3><a class="header" href="#schema-composition" id="schema-composition">Schema Composition</a></h3>
<p>There is a desire from CDL users to define data that is related in definition to other schemas, whether that be
via inheritance or composition. As composition is generally less problematic and simpler to implement than
inheritance, it could be implemented by slightly modifying the above specification. However, as composition/inheritance
is not needed at the moment and is a complex enough addition that it will require another RFC to properly describe,
it will be left out of the initial version here described.</p>
<h3><a class="header" href="#sql-type-mapping" id="sql-type-mapping">SQL Type Mapping</a></h3>
<p>For the most part, materialization will store calculated values in SQL-style databases. For most scalar types, there
is a well-defined mapping that describes what type to use for any given database (e.g., booleans and strings). There
are, on the other hand, types that do not have an agreed upon representation.</p>
<p>Proposed is the suggestion to store for each database materialized data is stored in a list of type mappings. This
would be in the config service (really, wherever the materialization configuration data is stored).</p>
<h2><a class="header" href="#further-considerations" id="further-considerations">Further Considerations</a></h2>
<h3><a class="header" href="#impact-on-other-teamsclients" id="impact-on-other-teamsclients">Impact on Other Teams/Clients</a></h3>
<p>Though validation is not currently being done on incoming data and therefore schema definitions don't matter
much at the moment, this will change not only all currently stored schema definitions but also all future schema
definition insertions. There will potentially need to be a one-time migration if anyone wants to keep their
schema definition. Likely, the volume of such request for conversion will be low enough to be doable manually.</p>
<p>However, we plan to explicitly document to our end users that we do not plan to run the migrations for them, as
we do not currently have any users relying on this feature and do not want to promise capacity we cannot fill.</p>
<h3><a class="header" href="#scalability" id="scalability">Scalability</a></h3>
<p>No impact. This simply changes the way that read-only Schemas have some metadata formatted.</p>
<h3><a class="header" href="#testing" id="testing">Testing</a></h3>
<p>This feature should undergo reasonable amounts of testing. Testing should include:</p>
<ul>
<li>Unit Tests:
<ul>
<li>Determination of view types from schema definition, simple and complex</li>
<li>Rendering of types to users, including schema composition</li>
</ul>
</li>
<li>Green Path Test</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../rfc/0020_Configuration_Service_01.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../rfc/0018_Transport_headers_passthrough_01.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../rfc/0020_Configuration_Service_01.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="../rfc/0018_Transport_headers_passthrough_01.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
